# Cool-Parser (Phase B)

## Design and overview
The assignment makes use of parser generator [ANTLR](https://github.com/antlr/antlr4/blob/master/doc/index.md), which outputs an [AST](https://en.wikipedia.org/wiki/Abstract_syntax_tree). The nodes of the AST are specified as classes in the **AST.java** file.

We have used the grammar rules written in the Phase A of Parser to write the AST generation code. The parser finds the matching grammar rule and adds a node to the AST.

The `program` rule is the converging point of the whole program. This is the root production of all rules.

---
Our parser follows precedence rules as specified in the COOL manual :
```
.
@
~
isvoid
* /
+ -
<= < = 
not
<-
```
---
For handling multiple entities of the same kind, we have used **lists**. This makes the implementation easy and helps to manage the long grammar rules. These lists are of two kinds :
* One, which are comma (`,`) separated. In these lists, having an entity is optional.
* And, another which are semicolon(`;`) separated. There has to be at least one entity in these lists. 

---

Some rules have optional constructs. For e.g. in `class_` rule having class inheritance is optional. So we have rules which deal with both the scenarios separated by `|`.
Here is the code from *.g4* file
``` c
// Without class inheritance
cl = CLASS t = TYPEID LBRACE ftre_list = feature_list RBRACE	
```
``` c
// With class inheritance
cl = CLASS t = TYPEID INHERITS inhrt_type=TYPEID LBRACE ftre_list = feature_list RBRACE
```
---
For the `INT_CONST` and `BOOL_CONST`, the *getText()* function returns a string, but we need the corresponding **int** and **bool** value to create the AST node. For this we used typecasting to get the required type.

For `INT_CONST` we used :
```
Integer.parseInt($i.getText())
```
For `BOOL_CONST` we used :
```
$bc.getText().charAt(0) == 't'
```
##  Test case analysis
The test case files are present in the **src/test_cases** directory. 

There are 3 correct programs namely`test1.cl`, `test2.cl`, and `test3.cl`. The rules which are tested by these programmes are mentioned in the comments of these respective files. For these programs the code outputs an AST. The AST output generated by the test case can be checked so that it matches the COOL manual specification. 

Also, there are 3 erogenous programs namely `test_error1.cl`, `test_error2.cl`, and `test_error3.cl`. These files produce a **parse  error** on compiling with error message `Compilation halted due to lex and parse errors`. The grammar rules for which the parse error comes is mentioned in the corresponding files in comments (along with line number). 

Also, we have verified that the first error printed by our code is same as the output of COOL compiler.

